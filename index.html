<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chetana CN - Associate Product Manager</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <nav class="top-nav">
        <div class="logo">Professional Resume Builder</div>
    </nav>

    <div class="side-controls">
        <button onclick="downloadPDF(this)" class="download-btn side-btn">
            <span class="btn-text">Download PDF</span>
            <span class="btn-loader" style="display:none;">Generating...</span>
        </button>
        <button onclick="downloadDOCX()" class="download-btn side-btn">Download DOCX</button>
    </div>

    <div class="resume-container">
        <aside class="sidebar">
            <header class="sidebar-header">
                <h1 id="res-name" contenteditable="true">Chetana CN</h1>
                <div class="divider"></div>
                <h2 id="res-title" contenteditable="true">ASSOCIATE PRODUCT MANAGER</h2>
            </header>

            <section class="sidebar-section">
                <h3>Details</h3>
                <p id="res-phone" contenteditable="true">8074712529</p>
                <p><a id="res-email" href="mailto:chinnnagireddy.chetana@gmail.com"
                        contenteditable="true">chinnnagireddy.chetana@gmail.com</a></p>
            </section>

            <section class="sidebar-section">
                <h3>Links</h3>
                <ul class="link-list">
                    <li><a id="res-link-linkedin" href="https://www.linkedin.com/in/c-n-chetana-93a716258/"
                            target="_blank" rel="noopener noreferrer" contenteditable="true">LinkedIn</a></li>
                    <li><a id="res-link-github" href="https://github.com/fixerpabo" target="_blank"
                            rel="noopener noreferrer" contenteditable="true">GitHub</a></li>
                    <li><a id="res-link-notion"
                            href="https://www.notion.so/2f8f6ae4ef9480f19144c745ca574cb2?v=2f8f6ae4ef9480ddaa9f000c276cc769&source=copy_link"
                            target="_blank" rel="noopener noreferrer" contenteditable="true">Notion</a></li>
                    <li><a id="res-link-medium" href="https://medium.com/@chinnanagireddy.chetana" target="_blank"
                            rel="noopener noreferrer" contenteditable="true">Medium</a></li>
                </ul>
            </section>

            <section class="sidebar-section">
                <h3>Skills</h3>
                <ul class="skill-list" contenteditable="true">
                    <li>Product Discovery</li>
                    <li>Problem Framing</li>
                    <li>MVP Scoping</li>
                    <li>PRD</li>
                    <li>Roadmapping</li>
                    <li>Feature Prioritization</li>
                    <li>Agile/Scrum</li>
                    <li>Sprint Planning</li>
                    <li>Cross-functional Leadership</li>
                    <li>Stakeholder Alignment</li>
                    <li>Business Analysis</li>
                    <li>UX Research</li>
                    <li>Product Iteration</li>
                    <li>AI Products</li>
                    <li>ATS</li>
                    <li>Product Strategy</li>
                    <li>Product Lifecycle Management</li>
                    <li>Requirements Gathering</li>
                    <li>Backlog Management</li>
                    <li>Product Analytics</li>
                    <li>Go-to-Market (GTM)</li>
                    <li>API Design & Integrations</li>
                    <li>UAT (User Acceptance Testing)</li>
                    <li>GPT / Claude</li>
                </ul>
            </section>
        </aside>

        <main class="main-content">
            <section class="content-section">
                <h3>Profile</h3>
                <p id="res-profile" contenteditable="true">Product Manager / Project Manager with 2+ years owning
                    end-to-end lifecycle
                    for 8+ products across
                    ERP, ATS, and AI/LLM platforms. Delivered 4+ MVPs with 30-40% faster time to market, 95% on-time
                    delivery across 3+ concurrent projects, and 25% less rework by aligning 15+ stakeholders.
                    Technically fluent in API design, data models, and UAT; metrics-driven on KPIs/OKRs, usability, and
                    outcome-focused roadmaps.</p>
            </section>

            <section class="content-section">
                <h3>Employment History</h3>
                <div class="job-entry">
                    <div class="job-header">
                        <h4 id="res-job-title" contenteditable="true">Product Manager / Project Manager / Business
                            Analyst, ADAINSYS</h4>
                        <span id="res-job-date" class="date" contenteditable="true">MAR 2022 — PRESENT</span>
                    </div>
                    <ul contenteditable="true">
                        <li>Owned end-to-end delivery of 8+ products across ERP, ATS, AI platforms, and
                            workflow/academic automation—from discovery and requirements to launch, iteration, and
                            adoption.</li>
                        <li>Defined problem statements, user journeys, and success metrics (KPIs/OKRs); performed
                            trade-off analysis to balance scope, speed, and scalability in high-ambiguity environments.
                        </li>
                        <li>Shipped 4+ MVPs with 30-40% faster time-to-market while maintaining extensible architectures
                            and clear product documentation (PRDs/BRDs, workflows, acceptance criteria).</li>
                        <li>Managed 3+ concurrent projects with cross-functional teams (6–10 engineers/design/QA),
                            driving ~95% on-time delivery via Agile/Scrum rituals, sprint planning, and backlog
                            management.</li>
                        <li>Aligned 15+ stakeholders on priorities under conflicting requirements, reducing rework by
                            ~25% through structured decision-making and clear change management.</li>
                        <li>Led UX research, usability testing, and UAT with 100+ users; resolved 90%+ critical issues
                            pre-release and improved overall product quality at launch.</li>
                        <li>Partnered with engineering on API design, system workflows, and data models; maintained
                            documentation in Notion and product writing on Medium.</li>
                    </ul>
                    <h5 class="initiatives-label" contenteditable="true">Selected product initiatives:</h5>
                    <ul class="initiatives-list" contenteditable="true">
                        <li><strong>AI Meeting Management Platform:</strong> scoped transcription, summaries, action
                            items, semantic search, and analytics using Whisper and GPT/Claude; collaborated on
                            AWS-based deployment approach.</li>
                        <li><strong>ATS Platform:</strong> delivered job posting, sourcing automation, recruiter
                            dashboards, and reporting/analytics workflows.</li>
                        <li><strong>ERP & Office Management:</strong> owned HR, attendance, and operational workflows to
                            digitize manual processes and enable role-based access.</li>
                        <li><strong>Academic/Attendance Systems:</strong> built QR-based attendance, analytics,
                            defaulter tracking, and export/reporting flows.</li>
                        <li><strong>No Dues Certificate Platform:</strong> digitized clearance into a role-based
                            workflow with automated PDF generation.</li>
                        <li><strong>Kids-Parent Video Platform:</strong> designed trust-first, age-restricted content
                            access and safety controls.</li>
                    </ul>
                </div>
            </section>

            <section class="content-section">
                <h3>Education</h3>
                <div class="education-entry">
                    <h4 id="res-edu-title" contenteditable="true">B.Tech, Computer Science, Marri Laxman Reddy Institute
                        of Technology</h4>
                    <p id="res-edu-gpa" contenteditable="true">GPA: 8.3/10</p>
                </div>
            </section>
        </main>
    </div>

    <!-- PDF Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- DOCX Generation Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        async function downloadPDF(btn) {
            const { jsPDF } = window.jspdf;
            const element = document.querySelector('.resume-container');

            // UI Feedback
            const btnText = btn.querySelector('.btn-text');
            const btnLoader = btn.querySelector('.btn-loader');
            btnText.style.display = 'none';
            btnLoader.style.display = 'inline';
            btn.disabled = true;

            // Blur any active edit to ensure focus rings aren't captured
            if (document.activeElement && document.activeElement.blur) {
                document.activeElement.blur();
            }

            // 1. Create a hidden iframe for isolated rendering
            // This fixes the alignment/offset issue by isolating the capture environment
            const iframe = document.createElement('iframe');
            iframe.style.position = 'fixed';
            iframe.style.left = '-10000px';
            iframe.style.top = '0';
            iframe.style.width = '794px';
            iframe.style.height = '1123px';
            document.body.appendChild(iframe);

            const iframeDoc = iframe.contentWindow.document;

            // 2. Clone Styles
            const styles = Array.from(document.styleSheets)
                .map(sheet => {
                    try {
                        return Array.from(sheet.cssRules).map(rule => rule.cssText).join('\n');
                    } catch (e) { return ''; }
                }).join('\n');

            // 3. Prepare Iframe Content
            iframeDoc.open();
            iframeDoc.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
                    <style>
                        ${styles}
                        .resume-container { 
                            width: 794px !important; 
                            height: 1123px !important; 
                            margin: 0 !important; 
                            box-shadow: none !important;
                            display: grid !important;
                            grid-template-columns: 33% 67% !important;
                        }
                        .top-nav, .side-controls, .button-group { display: none !important; }
                        body { margin: 0; padding: 0; background: white; overflow: hidden; }
                    </style>
                </head>
                <body>
                    ${element.outerHTML}
                </body>
                </html>
            `);
            iframeDoc.close();

            try {
                // 4. Wait for fonts and styles to load in iframe
                await new Promise(resolve => {
                    const checkLoaded = () => {
                        // Use the fonts.ready API for accurate loading check
                        if (iframe.contentWindow.document.readyState === 'complete') {
                            iframe.contentWindow.document.fonts.ready.then(() => {
                                setTimeout(resolve, 800); // Small buffer for rendering
                            });
                        } else {
                            setTimeout(checkLoaded, 100);
                        }
                    };
                    checkLoaded();
                });

                // 5. Generate PDF from Iframe content (Definitive 1:1 Parity)
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4',
                    compress: true,
                    precision: 16
                });

                // Get the cloned element from the iframe
                const frameElement = iframeDoc.querySelector('.resume-container');

                await doc.html(frameElement, {
                    callback: function (doc) {
                        const totalPages = doc.internal.getNumberOfPages();
                        if (totalPages > 1) {
                            for (let i = totalPages; i > 1; i--) { doc.deletePage(i); }
                        }
                        doc.save('Chetana_CN_Resume.pdf');

                        // Restore UI and cleanup
                        document.body.removeChild(iframe);
                        btnText.style.display = 'inline';
                        btnLoader.style.display = 'none';
                        btn.disabled = false;
                    },
                    x: 0,
                    y: 0,
                    width: 210,
                    windowWidth: 794,
                    html2canvas: {
                        scale: 2, // Increase scale for high-fidelity/sharp text
                        useCORS: true,
                        letterRendering: true,
                        backgroundColor: '#ffffff',
                        logging: false,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: 794,
                        windowHeight: 1123
                    }
                });
            } catch (err) {
                console.error('PDF Generation Error:', err);
                if (document.body.contains(iframe)) document.body.removeChild(iframe);
                alert('PDF generation failed. Check console.');
                btnText.style.display = 'inline';
                btnLoader.style.display = 'none';
                btn.disabled = false;
            }
        }

        function downloadDOCX() {
            // Fetch all current values from the page
            const name = document.getElementById('res-name').innerText;
            const title = document.getElementById('res-title').innerText;
            const phone = document.getElementById('res-phone').innerText;
            const email = document.getElementById('res-email').innerText;
            const jobTitle = document.getElementById('res-job-title').innerText;
            const jobDate = document.getElementById('res-job-date').innerText;
            const eduTitle = document.getElementById('res-edu-title').innerText;
            const eduGpa = document.getElementById('res-edu-gpa').innerText;
            const profile = document.querySelector('.content-section p').innerText;

            const skills = Array.from(document.querySelectorAll('.skill-list li')).map(li => `<li>${li.innerText}</li>`).join('');
            const jobBullets = Array.from(document.querySelectorAll('.job-entry > ul > li')).map(li => `<li>${li.innerText}</li>`).join('');
            const initiatives = Array.from(document.querySelectorAll('.initiatives-list li')).map(li => `<li>${li.innerText}</li>`).join('');

            const styles = `
                <style>
                    @page { size: A4; margin: 0; }
                    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; }
                    table { width: 100%; border-collapse: collapse; table-layout: fixed; }
                    .sidebar { width: 33%; background-color: #11342c; color: #ffffff; padding: 25pt 18pt; vertical-align: top; }
                    .content { width: 67%; background-color: #ffffff; padding: 25pt 22pt; vertical-align: top; }
                    h1 { font-family: 'Times New Roman', serif; font-size: 20pt; margin: 0 0 5pt 0; color: #ffffff; }
                    h2 { font-size: 8pt; text-transform: uppercase; letter-spacing: 1pt; margin-bottom: 20pt; color: #ffffff; }
                    h3 { font-size: 14pt; margin: 15pt 0 10pt 0; border-bottom: 1pt solid #eeeeee; padding-bottom: 3pt; color: #333333; }
                    .sidebar h3 { font-size: 11pt; border-bottom: none; color: #ffffff; }
                    p, li { font-size: 9pt; line-height: 1.4; color: #333333; margin-bottom: 5pt; }
                    .sidebar p, .sidebar li { color: #ffffff; opacity: 0.9; }
                    ul { margin: 0; padding-left: 12pt; }
                    .job-title { font-weight: bold; font-size: 10pt; color: #000000; }
                    .date { font-size: 8pt; color: #888888; text-transform: uppercase; }
                </style>
            `;

            const resumeHtml = `
                <html>
                    <head><meta charset="utf-8">${styles}</head>
                    <body>
                        <table>
                            <tr>
                                <td class="sidebar">
                                    <h1>${name}</h1>
                                    <h2>${title}</h2>
                                    <h3>Details</h3>
                                    <p>${phone}</p>
                                    <p>${email}</p>
                                    <h3>Links</h3>
                                    <ul>
                                        <li>${document.getElementById('res-link-linkedin').innerText}</li>
                                        <li>${document.getElementById('res-link-github').innerText}</li>
                                        <li>${document.getElementById('res-link-notion').innerText}</li>
                                        <li>${document.getElementById('res-link-medium').innerText}</li>
                                    </ul>
                                    <h3>Skills</h3>
                                    <ul>
                                        ${skills}
                                    </ul>
                                </td>
                                <td class="content">
                                    <h3>Profile</h3>
                                    <p>${document.getElementById('res-profile').innerText}</p>
                                    <h3>Employment History</h3>
                                    <p class="job-title">${jobTitle}</p>
                                    <p class="date">${jobDate}</p>
                                    <ul>
                                        ${jobBullets}
                                    </ul>
                                    <p><b>Selected product initiatives:</b></p>
                                    <ul>
                                        ${initiatives}
                                    </ul>
                                    <h3>Education</h3>
                                    <p class="job-title">${eduTitle}</p>
                                    <p>${eduGpa}</p>
                                </td>
                            </tr>
                        </table>
                    </body>
                </html>
            `;

            const converted = htmlDocx.asBlob(resumeHtml);
            saveAs(converted, 'Chetana_CN_Resume.docx');
        }
    </script>
</body>

</html>